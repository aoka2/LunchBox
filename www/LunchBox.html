<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<link href="css/lunchBox.css" rel="stylesheet" type="text/css">
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    
	<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.5.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="Content-Security-Policy" content="default-src * data: gap: https://ssl.gstatic.com; style-src * 'unsafe-inline'; script-src * 'unsafe-inline' 'unsafe-eval'">
    <script src="js/ncmb.min.js"></script>
    <script src="components/loader.js"></script>

	<title>LunchBox</title>
</head>
<body>
	<button onclick="location.href='home.html'">ホームへ</button>
	<div id="filter">

	<p>フィルター</p>
	<div class="allergy-filter">
		<button onclick="pulldownOpen()" id="filter-button">アレルギー🔽</button>
		<div id="filter-content" class="filter-content-style">
		</div>
	</div>

	<div class="favorite-filter">
	</div>
	<div class="dislike-filter">
	</div>

	<br>

	<input type="button" value="確認" onclick="filterHyde()">
	</div>
	<div class="final-check">
		<p>Are you sure??</p>
		<input type="button" value="はい" onclick="lunchMake()">
		<input type="button" value="いいえ" onclick="filterToBack()">
	</div>

	<div id="lunch-make">
		<img src="images/bento1.png" class="farstCooking" style="max-width : 50%" onclick="cookingResip()">
		<img src="images/bento1.png" class="secondCooking" style="max-width : 50%" onclick="cookingResip()">
		<img src="images/bento1.png" class="thaadCooking" style="max-width : 50%" onclick="cookingResip()">
		<br>
		<input type="button" value="確定" onclick="checkLunch()">

		<div class="cooking-detail">
			
		</div>
	</div>
	<script src="js/lunchBox.js"></script>
</body>

</html>

<script>

    //プルダウンオープン
let clickNumber = 0;
function pulldownOpen(){
    $("#filter-content").toggleClass("show");
    let element = $(".filter-content-style");

        //データベースAPIキー
    var applicationKey = "5b860744c00c138eecdcd0c0cd388247850c31abeac7efbd8e259ae1c14c0450";
    var clientKey = "c071bad9b72a08d21b4aa7b51686065a2d85c0fe4f7b458b201be32bea8bdb81";
    var ncmb = new NCMB(applicationKey,clientKey);
    
    if(clickNumber < 1){
        //DB取り出し
        var allergyFoods = ncmb.DataStore("allergy");
        allergyFoods.fetchAll().then(function(objects){
            //データ取得成功時
            for(let i = 0;i < objects.length;i++){
                var object = objects[i];
                const name = object.foodName;
                element.append(`<input type="checkbox" class="filter-content-button">${name}`);
                element.append("<br>");
            }
        }).catch(function(error){
            //取得失敗
            alert("error: " + error.code);
        });
    }
    clickNumber++;

}
//プルダウンクローズ
function pulldownClose(){
    
}

function filterHyde(){
    $('.final-check').css('display','block');
    $('#filter').css('display','none');
}

function lunchMake(){
    $('.final-check').css('display','none');
    $('#lunch-make').css('display','block');
}

function filterToBack(){
    $('.final-check').css('display','none');
    $('#filter').css('display','block');
}

function cookingResip(){
    $('.cooking-detail').css('display','block');
    let detailText = $(".cooking-detail");
    detailText.append("<p>あいうえお！</p>");

}

function checkLunch(){
    alert("かくてい！");
}

</script>